import{a as y}from"./chunk-WQPGKETM.js";import{g as $,h as z,i as A}from"./chunk-TLQWEWJL.js";import{a as f}from"./chunk-HZQYCWS3.js";import{g as T,h as N}from"./chunk-542AAHZQ.js";import"./chunk-CKMECCOM.js";import{Bb as c,Cb as d,Kb as j,Sa as h,Ua as a,Va as m,aa as I,ba as P,e as s,hb as u,ka as M,la as G,lb as l,lc as F,mc as C,nc as U,ob as n,oc as R,pb as r,qb as v,rb as D,sa as H,ta as k,tb as b,ub as x,xb as _,ya as E}from"./chunk-XYDWLSVQ.js";var S=(()=>{class i{getGeneros(e){return s(this,null,function*(){try{return(yield f.get(`${e}/api/Generos/all`)).data}catch(t){throw console.error("Error registering user:",t),t}})}sugerencias(e,t,o){return s(this,null,function*(){let g={userId:t,genPreferidos:o};try{return(yield f.post(`${e}/api/Sugerencias`,g)).data}catch(O){throw console.error("Error registering user:",O),O}})}getSugerencias(e,t){return s(this,null,function*(){try{return(yield f.get(`${e}/api/Sugerencias/${t}`)).data}catch(o){throw console.error("Error registering user:",o),o}})}getMoviesAll(e){return s(this,null,function*(){try{return(yield f.get(`${e}/api/Movies/all`)).data}catch(t){throw console.error("Error registering user:",t),t}})}getMoviesByGenreId(e,t){return s(this,null,function*(){try{return(yield f.get(`${e}/api/Movies/${t}`)).data}catch(o){throw console.error("Error registering user:",o),o}})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=I({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Q=i=>({selected:i});function W(i,p){if(i&1){let e=D();n(0,"div",5),b("click",function(){let o=H(e).$implicit,g=x();return k(g.toggleGeneroSelection(o.genreId))}),v(1,"img",6),n(2,"p"),c(3),r()()}if(i&2){let e=p.$implicit,t=x();l("ngClass",j(4,Q,t.isGeneroSelected(e.genreId))),a(),_("alt",e.genreName),l("src",e.imageUrl,h),a(2),d(e.genreName)}}var L=(()=>{class i{constructor(e,t,o,g){this.data=e,this.router=t,this.matDialogRef=o,this.HomeService=g,this.apiUrl=y.apiUrl,this.listGeneros=[],this.selectedGeneros=[],this.userId=1,this.bgFlag=!1,this.onGuardar=new E,this.matDialogRef.disableClose=!0}ngOnInit(){let e=localStorage.getItem("loggedUser");console.log(e),this.userId=Number(e),console.log(this.userId),this.getGenero()}redirectToRoute(){this.matDialogRef.close()}getGenero(){return s(this,null,function*(){this.listGeneros=yield this.HomeService.getGeneros(this.apiUrl),console.log(this.listGeneros)})}toggleGeneroSelection(e){let t=this.selectedGeneros.indexOf(e);t>-1?this.selectedGeneros.splice(t,1):this.selectedGeneros.length<5?this.selectedGeneros.push(e):console.log("Solo puedes seleccionar hasta 5 g\xE9neros.")}guardar(){this.saveSugerencias(),this.matDialogRef.close()}saveSugerencias(){return s(this,null,function*(){let e=yield this.HomeService.sugerencias(this.apiUrl,this.userId,this.selectedGeneros);console.log(e),this.onGuardar.emit(e)})}isGeneroSelected(e){return this.selectedGeneros.includes(e)}static{this.\u0275fac=function(t){return new(t||i)(m(z),m(T),m($),m(S))}}static{this.\u0275cmp=M({type:i,selectors:[["modal-home"]],outputs:{onGuardar:"onGuardar"},decls:7,vars:1,consts:[[1,"generos-container"],["class","genero-card",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"button-container","pb-5"],[1,"btn-saltar",3,"click"],[1,"btn-guardar",3,"click"],[1,"genero-card",3,"click","ngClass"],[1,"genero-image",3,"src","alt"]],template:function(t,o){t&1&&(n(0,"div",0),u(1,W,4,6,"div",1),r(),n(2,"div",2)(3,"button",3),b("click",function(){return o.redirectToRoute()}),c(4,"Saltar"),r(),n(5,"button",4),b("click",function(){return o.guardar()}),c(6,"Guardar"),r()()),t&2&&(a(),l("ngForOf",o.listGeneros))},dependencies:[F,C],styles:[".generos-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;justify-content:center;align-items:center;max-height:600px;overflow-y:auto;min-width:560px;overflow-x:hidden;padding:20px}.genero-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:space-between;width:120px;height:180px;padding:10px;border:2px solid transparent;border-radius:10px;transition:border-color .3s;cursor:pointer;background-color:#f9f9f9}.genero-card[_ngcontent-%COMP%]   img.genero-image[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:5px;object-fit:cover}.genero-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:10px;font-size:16px;font-weight:700;text-align:center}.genero-card[_ngcontent-%COMP%]:hover{border-color:#d3d3d3}.genero-card.selected[_ngcontent-%COMP%]{border-color:#00f;background-color:#add8e6}.generos-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.generos-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#888;border-radius:4px}.generos-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background-color:#555}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:100px;margin-top:20px}.btn-saltar[_ngcontent-%COMP%]{background-color:red;color:#fff;border:none;padding:10px 20px;cursor:pointer;font-size:16px;border-radius:5px}.btn-guardar[_ngcontent-%COMP%]{background-color:#00f;color:#fff;border:none;padding:10px 20px;cursor:pointer;font-size:16px;border-radius:5px}.btn-saltar[_ngcontent-%COMP%]:hover, .btn-guardar[_ngcontent-%COMP%]:hover{opacity:.8}"]})}}return i})();function X(i,p){if(i&1&&(n(0,"div",6),v(1,"img",7),n(2,"div",8)(3,"h3"),c(4),r(),n(5,"p"),c(6),r()()()),i&2){let e=p.$implicit;a(),_("alt",e.title),l("src",e.imageUrl,h),a(3),d(e.title),a(2),d(e.description)}}function Y(i,p){if(i&1&&(n(0,"div",6),v(1,"img",7),n(2,"div",8)(3,"h3"),c(4),r(),n(5,"p"),c(6),r()()()),i&2){let e=p.$implicit;a(),_("alt",e.title),l("src",e.imageUrl,h),a(3),d(e.title),a(2),d(e.description)}}function Z(i,p){if(i&1&&(n(0,"div",3)(1,"h2"),c(2,"Pel\xEDculas sugeridas"),r(),n(3,"div",4),u(4,X,7,4,"div",5),r(),n(5,"div",3)(6,"h2"),c(7,"Todas las pel\xEDculas"),r(),n(8,"div",4),u(9,Y,7,4,"div",5),r()()()),i&2){let e=x();a(4),l("ngForOf",e.sugerenciasData),a(5),l("ngForOf",e.movies)}}var V=(()=>{class i{constructor(e,t){this.dialog=e,this.HomeService=t,this.movies=[],this.moviesSugerencias=[],this.firstLogin=!0,this.apiUrl=y.apiUrl,this.bgflag=!1,this.sugerenciasData=[]}ngOnInit(){this.getMovies(),this.firstLogin?(this.bgflag=!0,this.dialog.open(L,{data:{loginflag:!0}}).componentInstance.onGuardar.subscribe(t=>{this.sugerencias=t.genPreferidos,this.userId=Number(t.userId),this.getMoviesBySugerencias()})):this.getSugerencias(this.userId)}getSugerencias(e){return s(this,null,function*(){this.bgflag=!1,this.userSugerencias=yield this.HomeService.getSugerencias(this.apiUrl,e),this.sugerencias=this.userSugerencias.genPreferidos,console.log(this.sugerencias)})}getMovies(){return s(this,null,function*(){this.movies=yield this.HomeService.getMoviesAll(this.apiUrl)})}getMoviesBySugerencias(){return s(this,null,function*(){if(this.sugerencias&&this.sugerencias.length>0){let e=this.sugerencias.map(t=>s(this,null,function*(){return console.log(t),yield this.HomeService.getMoviesByGenreId(this.apiUrl,t)}));this.sugerenciasData=yield Promise.all(e),this.sugerenciasData=this.sugerenciasData.flat(),console.log(this.sugerenciasData)}})}static{this.\u0275fac=function(t){return new(t||i)(m(A),m(S))}}static{this.\u0275cmp=M({type:i,selectors:[["home"]],decls:3,vars:1,consts:[[1,"min-h-screen","flex","flex-col","items-center","justify-center","relative","bg-cover","bg-center","bg-gray-900"],[1,"container"],["class","section",4,"ngIf"],[1,"section"],[1,"movies-grid"],["class","movie-card",4,"ngFor","ngForOf"],[1,"movie-card"],[1,"movie-image",3,"src","alt"],[1,"movie-info"]],template:function(t,o){t&1&&(n(0,"div",0)(1,"div",1),u(2,Z,10,2,"div",2),r()()),t&2&&(a(2),l("ngIf",o.sugerenciasData.length>0))},dependencies:[C,U],styles:["html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;background-color:#1f2937}.container[_ngcontent-%COMP%]{padding:20px}.section[_ngcontent-%COMP%]{margin-bottom:40px}h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:20px;color:#fff}.movies-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:20px}.movie-card[_ngcontent-%COMP%]{background-color:#1e1e1e;border-radius:10px;overflow:hidden;transition:transform .3s ease}.movie-card[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.movie-image[_ngcontent-%COMP%]{width:100%;height:300px;object-fit:cover}.movie-info[_ngcontent-%COMP%]{padding:10px;color:#fff}.movie-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;margin:10px 0}.movie-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#b3b3b3}"]})}}return i})();var q=[{path:"",component:V}];var Se=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=G({type:i})}static{this.\u0275inj=P({imports:[R,N.forChild(q)]})}}return i})();export{Se as HomeModule};
